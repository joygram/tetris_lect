---
layout: default
title: 4ë‹¨ê³„ - ë¸”ë¡ ì´ë™ êµ¬í˜„
---

# 4ë‹¨ê³„: ë¸”ë¡ ì´ë™ êµ¬í˜„

## ğŸ¯ ì´ ë‹¨ê³„ì—ì„œ ë°°ìš¸ ê²ƒ

- ë¸”ë¡ì˜ ì¢Œìš° ì´ë™
- ìë™ ë‚™í•˜ êµ¬í˜„
- íšŒì „ ê¸°ëŠ¥ êµ¬í˜„
- ì¶©ëŒ ê°ì§€

## ğŸ“ ì‹¤ìŠµ ë‚´ìš©

### 1. GameBoard ì—°ê²° ë° ê¸°ë³¸ êµ¬ì¡°

`Assets/Scripts/Tetromino.cs`ë¥¼ ë‹¤ìŒê³¼ ê°™ì´ ì‘ì„±í•©ë‹ˆë‹¤:

```csharp
using UnityEngine;

public class Tetromino : MonoBehaviour
{
    private GameBoard gameBoard;
    public float fallSpeed = 1f;  // ë‚™í•˜ ì†ë„ (ì´ˆ)
    private float fallTimer = 0f;
    
    void Start()
    {
        // GameBoard ì°¾ê¸°
        gameBoard = FindObjectOfType<GameBoard>();
        
        // ì´ˆê¸° ìœ„ì¹˜ëŠ” Spawnerì—ì„œ ì„¤ì •í•˜ê±°ë‚˜ ì—¬ê¸°ì„œ ì„¤ì •
        // transform.positionì€ Unity ì”¬ì—ì„œ ì„¤ì •ëœ Spawner ìœ„ì¹˜ ì‚¬ìš©
    }
    
    void Update()
    {
        // ìë™ ë‚™í•˜
        fallTimer += Time.deltaTime;
        if (fallTimer >= fallSpeed)
        {
            MoveDown();
            fallTimer = 0f;
        }
    }
}
```

### 2. ì´ë™ ê°€ëŠ¥í•œì§€ í™•ì¸í•˜ëŠ” í•¨ìˆ˜

**ì°¸ê³  ë¸”ë¡œê·¸ ë°©ì‹**: ìì‹ ë¸”ë¡ë“¤ì˜ ìœ„ì¹˜ë¥¼ ì§ì ‘ í™•ì¸í•©ë‹ˆë‹¤.

```csharp
// ì´ë™ ê°€ëŠ¥í•œì§€ í™•ì¸í•˜ëŠ” í•¨ìˆ˜
bool ValidMove(Vector3 offset)
{
    // ëª¨ë“  ìì‹ ë¸”ë¡ í™•ì¸
    for (int i = 0; i < transform.childCount; i++)
    {
        Transform child = transform.GetChild(i);
        
        // ì´ë™ í›„ ìœ„ì¹˜ ê³„ì‚°
        Vector3 newPos = child.position + offset;
        
        // Unity ì¢Œí‘œë¥¼ ì •ìˆ˜ë¡œ ë°˜ì˜¬ë¦¼ (ê²Œì„ ë³´ë“œ ê·¸ë¦¬ë“œì— ë§ì¶”ê¸°)
        int roundX = Mathf.RoundToInt(newPos.x);
        int roundY = Mathf.RoundToInt(newPos.y);
        
        // ë³´ë“œ ë²”ìœ„ í™•ì¸
        if (roundX < 0 || roundX >= gameBoard.width || 
            roundY < 0 || roundY >= gameBoard.height)
        {
            return false;  // ë²”ìœ„ ë°–!
        }
        
        // ì´ë¯¸ ë¸”ë¡ì´ ìˆëŠ”ì§€ í™•ì¸ (6ë‹¨ê³„ì—ì„œ êµ¬í˜„)
        // if (!gameBoard.IsCellEmpty(roundX, roundY))
        //     return false;
    }
    
    return true;  // ì´ë™ ê°€ëŠ¥!
}
```

**Mathf.RoundToInt() ì„¤ëª…**:
- ì†Œìˆ˜ì ì„ ë°˜ì˜¬ë¦¼í•˜ì—¬ ì •ìˆ˜ë¡œ ë§Œë“­ë‹ˆë‹¤
- ì˜ˆ: 5.2 â†’ 5, 5.7 â†’ 6, 10.8 â†’ 11
- Unity ì¢Œí‘œê°€ ì†Œìˆ˜ì ì¼ ìˆ˜ ìˆìœ¼ë¯€ë¡œ ì •ìˆ˜ë¡œ ë³€í™˜í•˜ì—¬ ê·¸ë¦¬ë“œì— ë§ì¶¥ë‹ˆë‹¤

### 3. ì´ë™ í•¨ìˆ˜ êµ¬í˜„

```csharp
public void MoveLeft()
{
    if (ValidMove(Vector3.left))  // ì™¼ìª½ìœ¼ë¡œ 1ì¹¸
    {
        transform.position += Vector3.left;
    }
}

public void MoveRight()
{
    if (ValidMove(Vector3.right))  // ì˜¤ë¥¸ìª½ìœ¼ë¡œ 1ì¹¸
    {
        transform.position += Vector3.right;
    }
}

public void MoveDown()
{
    if (ValidMove(Vector3.down))  // ì•„ë˜ë¡œ 1ì¹¸
    {
        transform.position += Vector3.down;
    }
    else
    {
        // ë” ì´ìƒ ë‚´ë ¤ê°ˆ ìˆ˜ ì—†ìœ¼ë©´ ë¸”ë¡ ê³ ì • (6ë‹¨ê³„ì—ì„œ êµ¬í˜„)
        // LockPiece();
    }
}
```

**ì‘ë™ ë°©ì‹**:
1. `ValidMove()`ë¡œ ì´ë™ ê°€ëŠ¥í•œì§€ í™•ì¸
2. ê°€ëŠ¥í•˜ë©´ `transform.position`ì„ ì§ì ‘ ë³€ê²½
3. ë¶€ëª¨ê°€ ì´ë™í•˜ë©´ ìì‹ ë¸”ë¡ë“¤ë„ í•¨ê»˜ ì´ë™ (Unityì˜ Transform ì‹œìŠ¤í…œ)

### 4. íšŒì „ ê¸°ëŠ¥ êµ¬í˜„

**ì°¸ê³  ë¸”ë¡œê·¸ ë°©ì‹**: ê° ìì‹ ë¸”ë¡ì˜ Local Positionì„ íšŒì „ì‹œí‚µë‹ˆë‹¤.

```csharp
public void Rotate()
{
    // íšŒì „ í›„ ìœ„ì¹˜ë“¤ì„ ì €ì¥í•  ë°°ì—´ (ìì‹ ê°œìˆ˜ë§Œí¼)
    Vector3[] newLocalPositions = new Vector3[transform.childCount];
    
    // ê° ìì‹ ë¸”ë¡ì˜ Local Positionì„ 90ë„ íšŒì „
    for (int i = 0; i < transform.childCount; i++)
    {
        Transform child = transform.GetChild(i);
        Vector3 localPos = child.localPosition;
        
        // 90ë„ ì‹œê³„ ë°©í–¥ íšŒì „ ê³µì‹: (x, y) â†’ (-y, x)
        float newX = -localPos.y;
        float newY = localPos.x;
        newLocalPositions[i] = new Vector3(newX, newY, 0);
    }
    
    // íšŒì „ í›„ ìœ„ì¹˜ê°€ ìœ íš¨í•œì§€ í™•ì¸
    bool canRotate = true;
    for (int i = 0; i < transform.childCount; i++)
    {
        Transform child = transform.GetChild(i);
        Vector3 newWorldPos = transform.position + newLocalPositions[i];
        
        // Unity ì¢Œí‘œë¥¼ ì •ìˆ˜ë¡œ ë°˜ì˜¬ë¦¼
        int roundX = Mathf.RoundToInt(newWorldPos.x);
        int roundY = Mathf.RoundToInt(newWorldPos.y);
        
        // ë³´ë“œ ë²”ìœ„ í™•ì¸
        if (roundX < 0 || roundX >= gameBoard.width || 
            roundY < 0 || roundY >= gameBoard.height)
        {
            canRotate = false;
            break;
        }
    }
    
    // íšŒì „ ê°€ëŠ¥í•˜ë©´ ì ìš©
    if (canRotate)
    {
        for (int i = 0; i < transform.childCount; i++)
        {
            Transform child = transform.GetChild(i);
            child.localPosition = newLocalPositions[i];
        }
    }
}
```

**íšŒì „ ê³µì‹ ì„¤ëª…**:
- 90ë„ ì‹œê³„ ë°©í–¥ íšŒì „: `(x, y) â†’ (-y, x)`
- ì˜ˆ: `(1, 0)` â†’ `(0, 1)`, `(0, 1)` â†’ `(-1, 0)`
- Local Positionì„ íšŒì „ì‹œí‚¤ë¯€ë¡œ, ë¶€ëª¨ ìœ„ì¹˜ëŠ” ê·¸ëŒ€ë¡œ ìœ ì§€ë©ë‹ˆë‹¤

## ğŸ”— ì´ì „ ë‹¨ê³„ì™€ì˜ ì—°ê²°

ì´ ë‹¨ê³„ì—ì„œëŠ” **3ë‹¨ê³„ì—ì„œ ë§Œë“  í”„ë¦¬íŒ¹**ì„ ì‚¬ìš©í•©ë‹ˆë‹¤:
- 3ë‹¨ê³„: Unityì—ì„œ í”„ë¦¬íŒ¹ ì§ì ‘ ë§Œë“¤ê¸° (I, O, T, S, Z, J, L)
- 4ë‹¨ê³„: í”„ë¦¬íŒ¹ìœ¼ë¡œ ìƒì„±ëœ ë¸”ë¡ì„ ì´ë™/íšŒì „

**2ë‹¨ê³„ì—ì„œ ë§Œë“  GameBoard**ë„ ì‚¬ìš©í•©ë‹ˆë‹¤:
- `gameBoard.width`, `gameBoard.height`: ë³´ë“œ í¬ê¸° í™•ì¸
- ë‚˜ì¤‘ì— `gameBoard.IsCellEmpty()`: ì¶©ëŒ í™•ì¸ (6ë‹¨ê³„ì—ì„œ ì‚¬ìš©)

**ì‘ë™ ë°©ì‹**:
- í”„ë¦¬íŒ¹ì„ Instantiateí•˜ë©´ ìì‹ ë¸”ë¡ë“¤ì´ í•¨ê»˜ ìƒì„±ë¨
- ë¶€ëª¨(Tetromino)ì˜ `transform.position`ì„ ë³€ê²½í•˜ë©´ ìì‹ë„ í•¨ê»˜ ì´ë™
- ìì‹ ë¸”ë¡ì˜ `localPosition`ì„ ë³€ê²½í•˜ë©´ íšŒì „ íš¨ê³¼

## ğŸ’¡ ì´ ë°©ì‹ì˜ ì¥ì 

**ì°¸ê³  ë¸”ë¡œê·¸ ë°©ì‹ (í”„ë¦¬íŒ¹ ê¸°ë°˜)**:
- âœ… **ê°„ë‹¨í•¨**: `transform.position` ì§ì ‘ ë³€ê²½
- âœ… **ì§ê´€ì **: Unity ì¢Œí‘œë¥¼ ê·¸ëŒ€ë¡œ ì‚¬ìš©
- âœ… **Mathf.RoundToInt()**: ì†Œìˆ˜ì ì„ ì •ìˆ˜ë¡œ ë³€í™˜í•˜ì—¬ ê·¸ë¦¬ë“œì— ë§ì¶¤
- âœ… **ìì‹ ë¸”ë¡ í™œìš©**: `transform.GetChild()`ë¡œ ì§ì ‘ ì ‘ê·¼
- âŒ Dictionary/List ë¶ˆí•„ìš”: 2ì°¨ì› ë°°ì—´ë§Œ ì•Œë©´ ë¨

## âœ… í™•ì¸ ì‚¬í•­

- [ ] ë¸”ë¡ì´ ì¢Œìš°ë¡œ ì´ë™í•˜ëŠ”ê°€?
- [ ] ë¸”ë¡ì´ ìë™ìœ¼ë¡œ ë‚™í•˜í•˜ëŠ”ê°€?
- [ ] íšŒì „ ê¸°ëŠ¥ì´ ì‘ë™í•˜ëŠ”ê°€?

## ğŸ“š ì°¸ê³  ìë£Œ

- [ì¢Œí‘œ ì²˜ë¦¬ ê°€ì´ë“œ](../ì°¸ê³ ìë£Œ/ì¢Œí‘œì²˜ë¦¬-ê°„ë‹¨ê°€ì´ë“œ.md)
- [í”„ë¡œê·¸ë¨ ì²˜ë¦¬ íë¦„](../ì°¸ê³ ìë£Œ/í”„ë¡œê·¸ë¨ì²˜ë¦¬íë¦„ì„¤ê³„.md)

---

[â† ì´ì „ ë‹¨ê³„: 3ë‹¨ê³„ - í…ŒíŠ¸ë¡œë¯¸ë…¸ ë¸”ë¡ ë§Œë“¤ê¸°](./3ë‹¨ê³„-í…ŒíŠ¸ë¡œë¯¸ë…¸-ë¸”ë¡-ë§Œë“¤ê¸°.md) | [ë‹¤ìŒ ë‹¨ê³„: 5ë‹¨ê³„ - ì…ë ¥ ì²˜ë¦¬ â†’](./5ë‹¨ê³„-ì…ë ¥-ì²˜ë¦¬.md)
